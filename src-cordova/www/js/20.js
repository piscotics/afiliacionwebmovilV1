(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"447f":function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"q-pa-md full-width row justify-center content-center"},[t("div",{staticStyle:{"min-width":"400px","max-width":"700px",padding:"0 20px"}},[t("q-table",{attrs:{title:"Usuarios","rows-per-page-label":"Items",separator:"cell",data:e.dataTable,columns:e.columns,"visible-columns":e.viewColumns,"row-key":"dataTable.id","rows-per-page-options":e.pagination,loading:e.loadingTable},scopedSlots:e._u([e.isMobile?null:{key:"top-right",fn:function(){return[t("q-btn",{attrs:{icon:"add",label:"Agregar Nuevo",color:"primary"},on:{click:e.addItem}})]},proxy:!0},{key:"header-cell-actions",fn:function(a){return[t("q-th",{attrs:{props:a}},[t("q-icon",{attrs:{name:"view_headline",size:"1.5em"}}),e._v("\n          "+e._s(a.col.label)+"\n        ")],1)]}},{key:"body-cell-actions",fn:function(a){return[t("q-td",{staticStyle:{width:"50px"},attrs:{props:a}},[t("q-btn",{attrs:{dense:"",round:"",flat:"",color:"positive",icon:"edit"},on:{click:function(t){return e.editItem(a)}}})],1)]}},{key:"body-cell-estado",fn:function(a){return[t("q-td",{attrs:{props:a}},[e._v("\n          "+e._s(e._f("FilterState")(a.row.estado))+"\n        ")])]}},{key:"no-data",fn:function(){return[t("div",{staticClass:"full-width row flex-center q-gutter-sm"},[t("span",[e._v(" No hay datos . . . crea el primer registro! ")])])]},proxy:!0}],null,!0)})],1),e.isMobile?t("div",{staticClass:"column items-center",staticStyle:{"padding-bottom":"0px"}},[t("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,50]}},[t("q-btn",{attrs:{fab:"",icon:"add",color:"primary"},on:{click:e.addItem}})],1)],1):e._e()])},o=[],l=t("11ce"),s=t("8039"),r=t("caca");let n=r["a"].getItem("pisco-afilweb");const d={list:async()=>{let e={subdominio:n.subdomain};return await l["a"].get(s["a"].apiUsuario+"list/",{params:e}).then((e=>e)).catch((e=>e.response))},create:async e=>{let a={username:e.username,password:e.password,idPersona:e.idPersona,nombre:e.nombre,apellido:e.apellido,renovarPass:1,estado:1,cargo:e.cargo,usuarioModif:e.usuarioModif,subdominio:n.subdomain};return await l["a"].post(s["a"].apiUsuario+"create/",a,{}).then((e=>e)).catch((e=>e.response))},edit:async(e,a)=>{let t={"Content-Type":"application/json"},i={username:a.username,password:a.password,idPersona:a.idPersona,nombre:a.nombre,apellido:a.apellido,renovarPass:1,estado:a.estado?0:1,cargo:a.cargo,usuarioModif:a.usuarioModif,subdominio:n.subdomain};return await l["a"].put(s["a"].apiUsuario+"update",i,{headers:t}).then((e=>e)).catch((e=>e.response))},get:async e=>{const a={"Content-Type":"application/json"};let t={username:e,subdominio:n.subdomain};return await l["a"].get(s["a"].apiUsuario+"get/",{params:t,headers:a}).then((e=>e)).catch((e=>e.response))}};var c=t("5bc2"),u=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("q-dialog",{ref:"dialog",on:{hide:e.onDialogHide}},[t("q-card",{staticClass:"q-dialog-plugin body-cards"},[t("q-card-section",[t("q-form",{ref:"form_modal"},[t("q-input",{attrs:{type:"text",filled:"",label:"Usuario","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.username,callback:function(a){e.username=a},expression:"username"}}),t("q-input",{attrs:{type:"password",filled:"",label:"Contraseña","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.password,callback:function(a){e.password=a},expression:"password"}}),t("q-input",{attrs:{type:"text",filled:"",label:"Identificacion","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.idPersona,callback:function(a){e.idPersona=a},expression:"idPersona"}}),t("q-input",{attrs:{type:"text",filled:"",label:"Nombres","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.nombre,callback:function(a){e.nombre=a},expression:"nombre"}}),t("q-input",{attrs:{type:"text",filled:"",label:"Apellidos","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.apellido,callback:function(a){e.apellido=a},expression:"apellido"}}),t("q-input",{attrs:{type:"text",filled:"",label:"Cargo","lazy-rules":"",rules:e.textRules,counter:""},model:{value:e.cargo,callback:function(a){e.cargo=a},expression:"cargo"}}),t("q-toggle",{attrs:{"checked-icon":"check",color:"red","unchecked-icon":"clear",value:e.estado,label:"Estado Usuario "+e.estadoText},model:{value:e.estado,callback:function(a){e.estado=a},expression:"estado"}})],1)],1),t("q-card-actions",{attrs:{align:"center"}},[t("q-btn",{attrs:{color:"primary",label:e.textAction},on:{click:e.onOKClick}}),t("q-btn",{attrs:{color:"primary",flat:"",label:"Cancelar"},on:{click:e.onCancelClick}})],1)],1)],1)},p=[],m={name:"ModalUser",data(){return{username:"",password:"",idPersona:"",nombre:"",apellido:"",estado:!0,estadoText:"Activo",cargo:"",textRules:[e=>e&&e.length>0||"Campo Obligatorio (*)",e=>e.length<=50||"Máximo 50 carácteres"],numberRules:[e=>!isNaN(parseFloat(e))&&e.length>=0||"Campo Obligatorio (*)"]}},props:{valueField1:{type:String,required:!0},valueField2:{type:String,required:!0},valueField3:{type:String,required:!0},valueField4:{type:String,required:!0},valueField5:{type:String,required:!0},valueField6:{type:Boolean,required:!0},valueField7:{type:String,required:!0},textAction:{type:String,required:!0}},created(){this.username=this.valueField1,this.password=this.valueField2,this.idPersona=this.valueField3,this.nombre=this.valueField4,this.apellido=this.valueField5,this.cargo=this.valueField7},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(){this.$refs.form_modal.validate().then((e=>{e&&(this.$emit("ok",{username:this.username,password:this.password,idPersona:this.idPersona,nombre:this.nombre,apellido:this.apellido,estado:this.estado,cargo:this.cargo}),this.hide())}))},onCancelClick(){this.hide()}},watch:{estado(){this.estadoText=this.estado?"Activo":" Inactivo"}}},b=m,h=t("a6c2"),g=t("ec6d"),f=t("5ce7"),v=t("7006"),y=t("3548"),w=t("a3be"),q=t("a184"),x=t("84df"),k=t("ef9c"),C=t("63c1"),F=t.n(C),A=Object(h["a"])(b,u,p,!1,null,null,null),P=A.exports;F()(A,"components",{QDialog:g["a"],QCard:f["a"],QCardSection:v["a"],QForm:y["a"],QInput:w["a"],QToggle:q["a"],QCardActions:x["a"],QBtn:k["a"]});var T={name:"Zones",data(){return{loadingTable:!1,pagination:[5,10,0],viewColumns:["actions","username","idPersona","nombre","apellido","estado","cargo"],columns:[{name:"actions",label:"",field:"",align:"center",icon:"delete"},{name:"id",required:!1,label:"id",field:"id",sortable:!1},{name:"username",required:!1,label:"Usuario",field:"username",sortable:!0,align:"left"},{name:"idPersona",required:!1,label:"Identificacion",field:"idPersona",sortable:!0,align:"left"},{name:"nombre",required:!1,label:"Nombres",field:"nombre",sortable:!0,align:"left"},{name:"apellido",required:!1,label:"Apellidos",field:"apellido",sortable:!0,align:"left"},{name:"estado",required:!1,label:"Estado",field:"estado",sortable:!0,align:"left"},{name:"cargo",required:!1,label:"Cargo",field:"cargo",sortable:!0,align:"left"}],dataTable:[],fabAction:!1}},beforeMount(){this.loadData()},methods:{editItem(e){this.fabAction=!1,this.saveOrEditItem(e.row)},addItem(){this.fabAction=!0,this.saveOrEditItem("")},saveOrEditItem(e){this.$q.dialog({component:P,valueField1:this.fabAction?"":e.username,valueField2:(this.fabAction,""),valueField3:this.fabAction?"":e.idPersona,valueField4:this.fabAction?"":e.nombre,valueField5:this.fabAction?"":e.apellido,valueField6:!this.fabAction&&!Boolean(e.estado),valueField7:this.fabAction?"":e.cargo,parent:this,textAction:this.fabAction?"Guardar":"Modificar"}).onOk((a=>{this.fabAction?this.addRegister(a):this.editRegister(a,e.id)})).onCancel((()=>{})).onDismiss((()=>{}))},async addRegister(e){await d.create(e).then((e=>{console.log(e),200===(null===e||void 0===e?void 0:e.status)?(c["a"].triggerPositive("Registro almacenado correctamente"),this.loadData()):c["a"].triggerNegative("El registro no pudo ser almacenado")}))},async editRegister(e,a){await d.edit(a,e).then((e=>{console.log(e),200===(null===e||void 0===e?void 0:e.status)?(c["a"].triggerPositive("Registro modificado correctamente"),this.loadData()):c["a"].triggerNegative("El registro no pudo ser modificado")}))},async loadData(){this.loadingTable=!0,await d.list().then((e=>{200===(null===e||void 0===e?void 0:e.status)&&(this.dataTable=e.data)})),this.loadingTable=!1}},computed:{isMobile:{get(){return this.$store.state.platform_mobile.isMobile}}}},_=T,I=t("3846"),Q=t("8e7e"),R=t("19dc"),S=t("7b08"),M=t("6d58"),O=Object(h["a"])(_,i,o,!1,null,null,null);a["default"]=O.exports;F()(O,"components",{QTable:I["a"],QBtn:k["a"],QTh:Q["a"],QIcon:R["a"],QTd:S["a"],QPageSticky:M["a"]})}}]);