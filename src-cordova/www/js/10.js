(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"58f0":function(a,e,t){"use strict";t.d(e,"a",(function(){return r}));var o=t("11ce"),i=t("8039"),n=t("caca");let s=n["a"].getItem("pisco-afilweb");const r={list:async()=>{let a={"Content-Type":"application/json"},e={subdominio:s.subdomain};return await o["a"].get(i["a"].apiPlan+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},create:async a=>{let e={"Content-Type":"application/json"},t={nombrePlan:a.name,valorBase:a.valorBase,valorAdicional:a.valorAdicional,estado:a.estado?0:1,subdominio:s.subdomain};return await o["a"].post(i["a"].apiPlan+"create/",t,{headers:e}).then((a=>a)).catch((a=>a.response))},edit:async(a,e)=>{let t={"Content-Type":"application/json"},n={id:a,nombrePlan:e.name,valorBase:e.valorBase,valorAdicional:e.valorAdicional,estado:e.estado?0:1,subdominio:s.subdomain};return await o["a"].put(i["a"].apiPlan+"update/",n,{headers:t}).then((a=>a)).catch((a=>a.response))},get:async a=>{const e={"Content-Type":"application/json"};let t={id:a,subdominio:s.subdomain};return await o["a"].get(i["a"].apiPlan+"get/",{params:t,headers:e}).then((a=>a)).catch((a=>a.response))}}},"745d":function(a,e,t){"use strict";t.r(e);var o=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"q-pa-md full-width row justify-center content-center"},[t("div",{staticStyle:{"min-width":"400px","max-width":"700px",padding:"0 20px"}},[t("q-table",{attrs:{title:"Novedades","rows-per-page-label":"Items",separator:"cell",data:a.dataTable,columns:a.columns,"visible-columns":a.viewColumns,"row-key":"dataTable.id","rows-per-page-options":a.pagination,loading:a.loadingTable},scopedSlots:a._u([a.isMobile?null:{key:"top-right",fn:function(){return[t("q-btn",{attrs:{icon:"add",label:"Agregar Nuevo",color:"primary"},on:{click:a.addItem}})]},proxy:!0},{key:"header-cell-actions",fn:function(e){return[t("q-th",{attrs:{props:e}},[t("q-icon",{attrs:{name:"view_headline",size:"1.5em"}}),a._v("\n          "+a._s(e.col.label)+"\n        ")],1)]}},{key:"body-cell-actions",fn:function(e){return[t("q-td",{staticStyle:{width:"50px"},attrs:{props:e}},[t("q-btn",{attrs:{dense:"",round:"",flat:"",color:"positive",icon:"edit"},on:{click:function(t){return a.editItem(e)}}})],1)]}},{key:"body-cell-estado",fn:function(e){return[t("q-td",{attrs:{props:e}},[a._v("\n          "+a._s(a._f("FilterState")(e.row.estado))+"\n        ")])]}},{key:"no-data",fn:function(){return[t("div",{staticClass:"full-width row flex-center q-gutter-sm"},[t("span",[a._v(" No hay datos . . . crea el primer registro! ")])])]},proxy:!0}],null,!0)})],1),a.isMobile?t("div",{staticClass:"column items-center",staticStyle:{"padding-bottom":"0px"}},[t("q-page-sticky",{attrs:{position:"bottom-left",offset:[18,50]}},[t("q-btn",{attrs:{fab:"",icon:"add",color:"primary"},on:{click:a.addItem}})],1)],1):a._e()])},i=[],n=t("11ce"),s=t("8039"),r=t("caca"),d=t("4e22"),l=t.n(d);let c,p,u=r["a"].getItem("pisco-afilweb");const h={list:async()=>{let a={"Content-Type":"application/json"};c=r["a"].getItem("contratoTitular");let e={subdominio:u.subdomain,idcontrato:c};return await n["a"].get(s["a"].apiNoveltycontract+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},create:async a=>{let e={"Content-Type":"application/json"};c=r["a"].getItem("contratoTitular"),p=r["a"].getItem("UsuarioLogueado");let t={idNovedad:a.idNovedad||0,idContrato:c,fechanovedad:l()(a.fechanovedad).format(),postfechadodia:a.postfechadodia||0,aplicada:a.aplicada||0,fechan:a.fechan||"1999-01-01",usuario:p||"",idcobrador:a.idcobrador||"",modulo:a.modulo||"",transac:a.transac||0,fechaprogramada:a.fechaprogramada||"1999-01-01",posicionx:a.posicionx||"",posiciony:a.posiciony||"",titular:a.titular||"",observaciones:a.observaciones||"",idalterna:a.idalterna||0,subdominio:u.subdomain};return await n["a"].post(s["a"].apiNoveltycontract+"create/",t,{headers:e}).then((a=>a)).catch((a=>a.response))},edit:async(a,e)=>{let t={"Content-Type":"application/json"};console.log("actualizar novedad",a),c=r["a"].getItem("contratoTitular"),p=r["a"].getItem("UsuarioLogueado");let o={idNovedadContrato:e.idNovedadContrato,idNovedad:e.idNovedad||0,idContrato:c,fechanovedad:l()(e.fechanovedad).format(),postfechadodia:e.postfechadodia||0,aplicada:e.aplicada||0,fechan:e.fechan||"1999-01-01",usuario:p||"",idcobrador:e.idcobrador||"",modulo:e.modulo||"",transac:e.transac||0,fechaprogramada:e.fechaprogramada||"1999-01-01",posicionx:e.posicionx||"",posiciony:e.posiciony||"",titular:e.titular||"",observaciones:e.observaciones||"",idalterna:e.idalterna||0,subdominio:u.subdomain};return await n["a"].put(s["a"].apiNoveltycontract+"update/",o,{headers:t}).then((a=>a)).catch((a=>a.response))},get:async a=>{const e={"Content-Type":"application/json"};let t={id:a,subdominio:u.subdomain};return await n["a"].get(s["a"].apiNoveltycontract+"get/",{params:t,headers:e}).then((a=>a)).catch((a=>a.response))}};t("58f0");var m=t("5bc2"),v=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("q-dialog",{ref:"dialog",on:{hide:a.onDialogHide}},[t("q-card",{staticClass:"q-dialog-plugin body-cards"},[t("q-card-section",[t("q-form",{ref:"form_modal"},[t("q-input",{attrs:{type:"text",filled:"",label:"Nro Novedad","lazy-rules":"",disable:"",counter:""},model:{value:a.idNovedadContrato,callback:function(e){a.idNovedadContrato=e},expression:"idNovedadContrato"}}),t("q-input",{attrs:{filled:"","option-value":"fechanovedad",label:"Fecha Novedad",clearable:"",disable:""},scopedSlots:a._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{"option-value":"fechanovedad",options:a.optionDatePicker,mask:"YYYY-MM-DD"},model:{value:a.fechanovedad,callback:function(e){a.fechanovedad=e},expression:"fechanovedad"}},[t("div",{staticClass:"row items-center justify-end"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cerrar",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:a.fechanovedad,callback:function(e){a.fechanovedad=e},expression:"fechanovedad"}}),t("br"),t("q-input",{attrs:{filled:"","option-value":"fechaprogramada",label:"Pr칩xima visita",clearable:""},scopedSlots:a._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[t("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[t("q-date",{attrs:{"option-value":"fechaprogramada",options:a.optionDatePicker,mask:"YYYY-MM-DD"},model:{value:a.fechaprogramada,callback:function(e){a.fechaprogramada=e},expression:"fechaprogramada"}},[t("div",{staticClass:"row items-center justify-end"},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cerrar",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:a.fechaprogramada,callback:function(e){a.fechaprogramada=e},expression:"fechaprogramada"}}),t("br"),t("q-select",{attrs:{filled:"",options:a.novedades,"option-value":"idNovedad","option-label":"novedad",label:"* Tipo Novedad","emit-value":"","map-options":"",rules:a.selRules},model:{value:a.idNovedad,callback:function(e){a.idNovedad=e},expression:"idNovedad"}}),t("q-input",{attrs:{type:"textarea",filled:"",label:"Novedad","lazy-rules":"",counter:"",rules:a.textRules},model:{value:a.observaciones,callback:function(e){a.observaciones=e},expression:"observaciones"}})],1)],1),t("q-card-actions",{attrs:{align:"center"}},[t("q-btn",{attrs:{color:"primary",label:a.textAction},on:{click:a.onOKClick}}),t("q-btn",{attrs:{color:"primary",flat:"",label:"Cancelar"},on:{click:a.onCancelClick}})],1)],1)],1)},f=[],b=(t("534d"),t("945f")),g={name:"ModalNoveltyContract",data(){return{idNovedadContrato:"",fechanovedad:l()().format("YYYY-MM-DD").toString(),fechaprogramada:"",observaciones:"",novedades:[],idNovedad:"",textRules:[a=>a&&a.length>0||"Campo Obligatorio (*)",a=>a.length<=50||"M치ximo 50 car치cteres"],selRules:[a=>!!a||"Campo Obligatorio"],numberRules:[a=>!isNaN(parseFloat(a))&&a.length>=0||"Campo Obligatorio (*)"]}},props:{valueField1:{type:Number,required:!0},valueField2:{type:Number,required:!0},valueField4:{type:String,required:!0},valueField12:{type:String,required:!0},valueField16:{type:String,required:!0},textAction:{type:String,required:!0}},created(){this.loadData(),this.idNovedadContrato=this.valueField1,0!=this.valueField2&&(this.idNovedad=this.valueField2),0!=this.valueField4&&"1999-01-01T00:00:00"!=this.valueField4&&(this.fechanovedad=l()(this.valueField4).format("YYYY-MM-DD")),console.log("la fecha",this.valueField12),0!=this.valueField12&&"1999-01-01T00:00:00"!=this.valueField12?this.fechaprogramada=l()(this.valueField12).format("YYYY-MM-DD"):this.fechaprogramada="",this.observaciones=this.valueField16},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},optionDatePicker(a){return a>=l()().format("YYYY/MM/DD").toString()},async loadData(){this.$q.loading.show({message:"<span class='text-orange text-weight-bold'>Consultando par치metros, por favor espere...</span>"}),await Promise.all([b["a"].novelty()]).then((a=>{console.log(a),this.novedades=a[0].data})).catch((a=>{console.log({err:a}),this.novedades=[]})),this.$q.loading.hide()},onOKClick(){this.$refs.form_modal.validate().then((a=>{a&&(console.log("xxx#11"),this.$emit("ok",{idNovedadContrato:this.idNovedadContrato,idNovedad:this.idNovedad,fechanovedad:this.fechanovedad,fechaprogramada:this.fechaprogramada,observaciones:this.observaciones}),this.hide())}))},onCancelClick(){this.hide()}}},y=g,C=t("a6c2"),N=t("ec6d"),w=t("5ce7"),q=t("7006"),x=t("3548"),T=t("a3be"),F=t("19dc"),k=t("5142"),I=t("7213"),D=t("ef9c"),A=t("f636"),P=t("84df"),Y=t("f6b1"),M=t("63c1"),S=t.n(M),j=Object(C["a"])(y,v,f,!1,null,null,null),_=j.exports;let O;S()(j,"components",{QDialog:N["a"],QCard:w["a"],QCardSection:q["a"],QForm:x["a"],QInput:T["a"],QIcon:F["a"],QPopupProxy:k["a"],QDate:I["a"],QBtn:D["a"],QSelect:A["a"],QCardActions:P["a"]}),S()(j,"directives",{ClosePopup:Y["a"]});var Q={name:"NoveltyContract",data(){return{loadingTable:!1,pagination:[5,10,0],viewColumns:["actions","idNovedadContrato","fechanovedad","usuario","observaciones"],columns:[{name:"actions",label:"",field:"",align:"center",icon:"delete"},{name:"idNovedadContrato",required:!1,label:"Nro Novedad",field:"idNovedadContrato",sortable:!0,align:"left"},{name:"fechanovedad",required:!1,label:"Fecha",field:"fechanovedad",sortable:!0,align:"left"},{name:"usuario",required:!1,label:"Usuario",field:"usuario",sortable:!0,align:"left"},{name:"observaciones",required:!1,label:"Novedad",field:"observaciones",sortable:!0,align:"left"}],dataTable:[],fabAction:!1}},beforeMount(){this.loadData()},methods:{editItem(a){this.fabAction=!1,this.saveOrEditItem(a.row)},addItem(){this.fabAction=!0,this.saveOrEditItem("")},saveOrEditItem(a){this.$q.dialog({component:_,valueField1:this.fabAction?0:a.idNovedadContrato,valueField2:this.fabAction?0:a.idNovedad,valueField3:this.fabAction?"":a.idContrato,valueField4:this.fabAction?"":a.fechanovedad,valueField5:this.fabAction?0:a.postfechadodia,valueField6:this.fabAction?0:a.aplicada,valueField7:this.fabAction?"":a.fechan,valueField8:this.fabAction?"":a.usuario,valueField9:this.fabAction?"":a.idcobrador,valueField10:this.fabAction?"":a.modulo,valueField11:this.fabAction?0:a.transac,valueField12:this.fabAction?"":a.fechaprogramada,valueField13:this.fabAction?"":a.posicionx,valueField14:this.fabAction?"":a.posiciony,valueField15:this.fabAction?"":a.titular,valueField16:this.fabAction?"":a.observaciones,valueField17:this.fabAction?0:a.idalterna,parent:this,textAction:this.fabAction?"Guardar":"Modificar"}).onOk((e=>{this.fabAction?this.addRegister(e):this.editRegister(e,a.id)})).onCancel((()=>{})).onDismiss((()=>{}))},async addRegister(a){await h.create(a).then((a=>{console.log(a),200===(null===a||void 0===a?void 0:a.status)?(m["a"].triggerPositive("Registro almacenado correctamente"),this.loadData()):m["a"].triggerNegative("El registro no pudo ser almacenado")}))},async editRegister(a,e){console.log("actu novedad",a,e),await h.edit(e,a).then((a=>{console.log(a),200===(null===a||void 0===a?void 0:a.status)?(m["a"].triggerPositive("Registro modificado correctamente"),this.loadData()):m["a"].triggerNegative("El registro no pudo ser modificado")}))},async loadData(){this.loadingTable=!0,O=r["a"].getItem("contratoTitular"),console.log("sin novedad ",O),null==O?(localStorage.setItem("buscarNovedad","Si"),this.$router.push({path:"/search"})):(this.loadingTable=!0,localStorage.setItem("buscarNovedad","No"),await h.list().then((a=>{if(200===(null===a||void 0===a?void 0:a.status)){for(let e in a.data)a.data[e].fechanovedad=l()(a.data[e].fechanovedad).format("YYYY-MMM-DD");this.dataTable=a.data}}))),this.loadingTable=!1}},computed:{isMobile:{get(){return this.$store.state.platform_mobile.isMobile}}}},R=Q,$=t("3846"),E=t("8e7e"),B=t("7b08"),z=t("6d58"),U=Object(C["a"])(R,o,i,!1,null,null,null);e["default"]=U.exports;S()(U,"components",{QTable:$["a"],QBtn:D["a"],QTh:E["a"],QIcon:F["a"],QTd:B["a"],QPageSticky:z["a"]})},"945f":function(a,e,t){"use strict";t.d(e,"a",(function(){return l}));var o=t("11ce"),i=t("8039"),n=t("caca");let s,r,d=n["a"].getItem("pisco-afilweb");const l={departments:async()=>{let a={"Content-Type":"application/json"},e={subdominio:d.subdomain};return await o["a"].get(i["a"].apiDepartamento+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},cities:async a=>{const e={"Content-Type":"application/json"};let t={codDepartamento:a,subdominio:d.subdomain};return await o["a"].get(i["a"].apiDepartamento+"cities/",{params:t,headers:e}).then((a=>a)).catch((a=>a.response))},paymentMethods:async()=>{let a={"Content-Type":"application/json"},e={subdominio:d.subdomain};return await o["a"].get(i["a"].apiFormaPago+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},paymentTypes:async()=>{console.log("llego a cargar tipos pagos");let a={"Content-Type":"application/json"},e={subdominio:d.subdomain};return await o["a"].get(i["a"].apiTipoPago+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},cash:async()=>{let a={"Content-Type":"application/json"},e={subdominio:d.subdomain};return await o["a"].get(i["a"].apiCaja+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},novelty:async()=>{let a={"Content-Type":"application/json"},e={subdominio:d.subdomain};return await o["a"].get(i["a"].apiNovelty+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))},serviceadicional:async a=>{let e,t={"Content-Type":"application/json"};return"Paga Valor Por el Grupo"==a?e={TIPOSERVICIO:1,subdominio:d.subdomain}:"Paga valor por Cada Una de las Personas"==a?e={TIPOSERVICIO:2,subdominio:d.subdomain}:"Paga valor Por una Persona en Especial"==a&&(e={TIPOSERVICIO:3,subdominio:d.subdomain}),await o["a"].get(i["a"].apiServiceadicional+"list/",{params:e,headers:t}).then((a=>a)).catch((a=>a.response))},titularesBeneficiarios:async()=>{let a={"Content-Type":"application/json"};s=n["a"].getItem("identificacionTitular"),r=n["a"].getItem("contratoTitular");let e={subdominio:d.subdomain,identificaciontitular:s,idcontrato:r};return await o["a"].get(i["a"].apiTitularesBeneficiarios+"list/",{params:e,headers:a}).then((a=>a)).catch((a=>a.response))}}}}]);